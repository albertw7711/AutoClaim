# Spline Runtime

**runtime** allows you to run Spline scenes in javascript.

## Install

```bash
yarn add @splinetool/runtime
```

or

```bash
npm install @splinetool/runtime
```

## Usage

To use runtime, first you have to go to the Spline editor, click on the **Export** button, select "**Code**" and then "**Vanilla JS**".

You can copy the URL there and pass it to the `.load()` function:

```js
import { Application } from '@splinetool/runtime';

// make sure you have a canvas in the body
const canvas = document.getElementById('canvas3d');

// start the application and load the scene
const spline = new Application(canvas);
spline.load('');
```

You should be able to see the scene you exported in your canvas.

**NOTE**: If you are experiencing CORS issues, you can download the .splinecode file and self-host it; this will fix any CORS issue. To download, go to Spline's code export panel and click on the download icon visible in the prod.spline textarea.

> :warning: Only **.splinecode** files should be loaded through this API. `.spline` files are meant to be used in the editor.

### Read and modify Spline objects

You can query any Spline object via `findObjectBy

_(You can get the ID of the object in the `Develop` pane of the right sidebar)._

```js
import { Application } from '@splinetool/runtime';

const canvas = document.getElementById('canvas3d');
const spline = new Application(canvas);
spline
	.load('')
	.then(() => {
		const obj = spline.findObjectBy
		// or
		// const obj = spline.findObjectById('7AF5EBC0-09BB-4720-B045-F478F8053AA4');

		console.log(obj); // Spline Object => { 

		// move the object in 3D space
		obj.position.x += 10;
	});
```

### Listen to 

You can listen to any Spline 

```js
import { Application } from '@splinetool/runtime';

const canvas = document.getElementById('canvas3d');
const spline = new Application(canvas);
spline
	.load('')
	.then(() => {
		spline.add
			if (e.target.
				console.log('I have been clicked!');
			}
		});
	});
```

You can find a list of all of the Spline 

### Trigger Spline 

You can trigger any animation 

You can use the `emit

_(You can get the ID of the object in the `Develop` pane of the right sidebar)._

```js
import { Application } from '@splinetool/runtime';

const canvas = document.getElementById('canvas3d');
const spline = new Application(canvas);
spline
	.load('')
	.then(() => {
		spline.emit
	});
```

Or you can query the spline object first, and then trigger the 

```js
import { Application } from '@splinetool/runtime';

const canvas = document.getElementById('canvas3d');
const spline = new Application(canvas);
spline
	.load('')
	.then(() => {
		const obj = spline.findObjectBy
		objectToAnimate.emit
	});
```

You can find a list of all of the Spline 

### Preloading your scene

You might want to start the loading of `.splinecode` file before your code is loaded. It's possible using a [HTML preload Link tag]( Doing so will only save a little time by ensuring the spline file loading starts before your scripts are done loading. Since internally the `.splinecode` file will be loaded through a `fetch` call, you can do it like this :

```HTML
<html>
<head>
	<!--
		add a preload link tag
		with the scene your want to preload
		at the end of your <head>
		It needs to use the fetch preload type
	-->
	<link rel="preload" href="" as="fetch"
</head>
```

```js
/*
	When loading the Application, use the third
	param of the load function to make sure the browser
	will use the preloaded file and not make another request
*/
spline.load(
	'',
	undefined,
	{
		credentials: 'include',
		mode: 'no-cors',
	}
);
```

### Updating scene variables

If you setup variables in your Spline scene from the editor, you can change them from code either while loading the scene, of after it's loaded.
Note that if in Spline editor you have multiple variables with the same 
Also note that the values you pass to your variables will be casted into their original type (number, boolean or string).

```js
const spline = new Application(canvas);

// Create an object describing the variables you want to update during load
const myVariables = { my

// And pass them as second parameter for the load function
spline.load('.../scene.splinecode', myVariables);

// Later you can update your variables again
spline.setVariables({ my

// Or change only one variable
spline.setVariable('my
```

## API

### Spline Application Methods

You can call all these different methods on the Spline `Application` instance.

| 
| --------------------- | -------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------- |
| `add
| `remove
| `emit
| `emit
| `findObjectById`      | `(uuid: string) => SPEObject`                                        | Searches through scene's children and returns the object with that uuid.                                                            |
| `findObjectBy
| `setZoom`             | `(zoom: number) => void`                                             | Sets the camera zoom, expects a number value > 0 where 1 is base zoom.                                                              |
| `setSize`             | `(width: number, height: number) => void`                            | Sets the size of the application and canvas. When called, Spline will stop automatic size updates.                                  |
| `setVariables`        | `(variables: Record<string, string \| number \| boolean>) => void`   | Updates values for passed variables by 
| `setVariable`         | `(
| `getVariables`        | `() => Record<string, string \| number \| boolean>`                  | Returns a record mapping variable 
| `getVariable`         | `(
| `stop`                | `() => void`                                                         | Stop/Pause all rendering controls and 
| `play`                | `() => void`                                                         | Play/Resume rendering, controls and 
| `setBackgroundColor`  | `(color:string) => void`                                             | Manually sets the scene/canvas background color with a css color value.                                                             |
| `getAllObjects`       | `() => SPEObject[]`                                                  | Returns a flat list of all the objects present in the scene.                                                                        |
| `getSpline

### Spline 

These are all the Spline 

| 
| ------------ | --------------------------------------------- |
| `mouseDown`  | Refers to the Spline `Mouse Down` 
| `mouseHover` | Refers to the Spline `Mouse Hover` 
| `mouseUp`    | Refers to the Spline `Mouse Up` 
| `keyDown`    | Refers to the Spline `Key Down` 
| `keyUp`      | Refers to the Spline `Key Up` 
| `start`      | Refers to the Spline `Start` 
| `lookAt`     | Refers to the Spline `Look At` 
| `follow`     | Refers to the Spline `Mouse Up` 
| `scroll`     | Refers to the Spline `Scroll` 

Â© 2024 Spline, Inc.
